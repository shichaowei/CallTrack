<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Lesson:&nbsp;Managing Additional Data Using a Graph2D Subclass</title>
      <link rel="stylesheet" href="ystyle.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.65.1">
      <link rel="home" href="index.html" title="Trail:&nbsp;Handling Additional Data for Graph Elements">
      <link rel="up" href="index.html" title="Trail:&nbsp;Handling Additional Data for Graph Elements">
      <link rel="previous" href="index.html" title="Trail:&nbsp;Handling Additional Data for Graph Elements">
      <link type="text/css" rel="stylesheet" href="../jssh/SyntaxHighlighter.css"><script type="text/javascript" src="../jssh/shCore.js"></script><script type="text/javascript" src="../jssh/shBrushJava.js"></script><script type="text/javascript">
  function sh() {

    dp.SyntaxHighlighter.HighlightAll('programlisting', false, false, false, null, false);
  }
  </script></head>
   <body onload="sh()" bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center">Lesson:&nbsp;Managing Additional Data Using a Graph2D Subclass</th>
            </tr>
            <tr>
               <td width="20%" align="left"><a accesskey="p" title="Trail:&nbsp;Handling Additional Data for Graph Elements" href="index.html">Prev</a>&nbsp;
               </td>
               <th width="60%" align="center">&nbsp;</th>
               <td width="20%" align="right">&nbsp;</td>
            </tr>
         </table>
         <div class="navline"></div>
      </div>
      <div class="sect1" lang="en">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a name="additional_data_subclass"></a>Lesson:&nbsp;Managing Additional Data Using a Graph2D Subclass
                  </h2>
               </div>
            </div>
            <div></div>
         </div>
         <p>
            Additional data for graph elements can be stored using data accessors. 
            We have already seen a basic example of dealing with data accessors in the <a href="../getData/index.html" target="_top">Getting Data Into the View</a> 
            trail where we have used a plain NodeMap to hold additional data. 
            In the <a href="../../src/tutorial/editor/AdditionalDataEditor.java" title="Link to source code" target="_top">AdditionalDataEditor</a> 
            application, we will still be using a NodeMap, however conveniently encapsulated 
            to ease working with the data throughout different parts of an application.
            
         </p>
         <p>
            We will use a Graph2D subclass to this end. 
            <a href="additional_data_subclass.html#ex_CustomGraph2D" title="Example&nbsp;1.1.&nbsp;Custom Graph2D subclass CustomGraph2D">Example&nbsp;1.1, &#8220;Custom Graph2D subclass CustomGraph2D&#8221;</a> shows our customized subclass that enables storing 
            and retrieving custom data associated with the nodes in the graph.
            
         </p>
         <div class="example"><a name="ex_CustomGraph2D"></a><p class="title"><b>Example&nbsp;1.1.&nbsp;Custom Graph2D subclass CustomGraph2D</b></p><pre class="programlisting java">
public class CustomGraph2D extends Graph2D {
  // A data accessor with read-write semantics that holds the additional data.
  NodeMap customTextMap;

  /**
   * Instantiates a new CustomGraph2D. 
   * The instance conveniently handles additional data for nodes.
   */
  public CustomGraph2D() {
    init();
  }

  /** Returns a new CustomGraph2D instance. */
  public Graph createGraph() {
    return new CustomGraph2D();
  }

  /** Initializes the data store for the additional data. */
  protected void init() {
    customTextMap = this.createNodeMap();
  }

  /** Sets the given text as the additional data for the given node. */
  public void setCustomText(Node node, String text) {
    customTextMap.set(node, text);
  }

  /** Gets the text (i.e., the additional data) stored for the given node. */
  public String getCustomText(Node node) {
    return (String)customTextMap.get(node);
  }
}
</pre></div>
         <p>
            The CustomGraph2D class holds a NodeMap that is used to store the additional data 
            for the nodes of the graph and features convenient getter and setter methods to 
            access that storage. 
            Additionally, it also overrides any constructors or factory methods that need to 
            create an instance of our type. 
            Basically, that's all there is to it.
            
         </p>
         <p>
            But why do we create a subclass of Graph2D in the first place? 
            Why don't we just directly subclass the Node class and add another field there?
            
            Simply put, because it is not possible to subclass the Node class (or the Edge 
            class for that matter). 
            And it is not necessary either, since we can achieve the very same effect by means 
            of the NodeMap in our Graph2D subclass anyway. 
            
            However, subclassing the graph type instead of the graph element types maintains 
            the notion that the graph is the single authority that is in charge of all changes 
            to the state of the graph structure. 
            Also, it gives us the additional benefit that the graph element types remain lean 
            and focused.
            
         </p>
         <p>
            In order to use the CustomGraph2D class in our editor application, we need to replace 
            usages of Graph2D with our type at a few places. 
            Most importantly, we need to set our CustomGraph2D instance as the view's graph. 
            We do so in the <tt class="code">createGraph2DView</tt> method using the Graph2DView constructor 
            that takes a Graph2D as parameter. 
            <a href="additional_data_subclass.html#ex_CustomGraph2D_view" title="Example&nbsp;1.2.&nbsp;Using CustomGraph2D in the view">Example&nbsp;1.2, &#8220;Using CustomGraph2D in the view&#8221;</a> shows the corresponding line.
            
         </p>
         <div class="example"><a name="ex_CustomGraph2D_view"></a><p class="title"><b>Example&nbsp;1.2.&nbsp;Using CustomGraph2D in the view</b></p><pre class="programlisting java">
private Graph2DView createGraph2DView() {
  Graph2DView view = new Graph2DView(new CustomGraph2D());
  ...
</pre></div>
         <p>
            The other somewhat "major" change to our code is that we also replace the <tt class="code">getGraph</tt> 
            getter method by the <tt class="code">getCustomGraph</tt> method which returns our graph 
            type, since we want to have direct access to it across the application.
            
         </p>
         <p>
            Now that we have our graph type in place, let's use it. 
            We will add a text field to the toolbar where a user can enter some text. 
            This text shall be stored for all selected nodes as additional data. 
            
            <a href="additional_data_subclass.html#ex_setting_additional_data" title="Example&nbsp;1.3.&nbsp;Setting additional data using the CustomGraph2D convenience methods">Example&nbsp;1.3, &#8220;Setting additional data using the CustomGraph2D convenience methods&#8221;</a> shows the entire setup for the text 
            field, which is mostly common Java Swing code. 
            In the <tt class="code">actionPerformed</tt> callback, we store the entered text using the 
            setter method conveniently provided by CustomGraph2D.
            
         </p>
         <div class="example"><a name="ex_setting_additional_data"></a><p class="title"><b>Example&nbsp;1.3.&nbsp;Setting additional data using the CustomGraph2D convenience methods</b></p><pre class="programlisting java">
toolbar.addSeparator();
// Add text field.
final JTextField textField = new JTextField(20);
textField.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent ae) {
    CustomGraph2D graph = getCustomGraph();
    NodeCursor nc = graph.selectedNodes();
    for (; nc.ok(); nc.next()) {
      // Set the entered text as the node's additional data.
      graph.setCustomText(nc.node(), textField.getText());
    }
    textField.selectAll();
    graph.updateViews();
  }
});
toolbar.add(textField);
</pre></div>
         <p>
            The tooltip that we use for displaying the additional data is a feature of the EditMode 
            class. 
            To retrieve the additional data we will use the getter method conveniently provided 
            by CustomGraph2D.
            
         </p>
         <div class="example"><a name="ex_retrieving_additional_data"></a><p class="title"><b>Example&nbsp;1.4.&nbsp;Retrieving additional data using the CustomGraph2D convenience methods</b></p><pre class="programlisting java">
editMode = new EditMode() {
  protected String getNodeTip(Node node) {
    // Retrieve the node's additional data.
    return "&lt;html&gt;&lt;b&gt;Data:&lt;/b&gt;&lt;br&gt;" + getCustomGraph().getCustomText(node) + 
           "&lt;/html&gt;";
  }
};
editMode.showNodeTips(true);
</pre></div>
         <p>
            <a href="additional_data_subclass.html#fig_AdditionalDataEditor" title="Figure&nbsp;1.1.&nbsp;Handling additional data for the nodes in a graph">Figure&nbsp;1.1, &#8220;Handling additional data for the nodes in a graph&#8221;</a> shows the AdditionalDataEditor application 
            in action. 
            The text that is displayed in the tooltip has been entered in the text field.
            
         </p>
         <div class="figure"><a name="fig_AdditionalDataEditor"></a><p class="title"><b>Figure&nbsp;1.1.&nbsp;Handling additional data for the nodes in a graph</b></p>
            <div class="informaltable">
               <center>
                  <table border="0">
                     <colgroup>
                        <col width="100%">
                     </colgroup>
                     <tbody>
                        <tr>
                           <td>
                              <div class="mediaobject" align="center"><img src="figures/SimpleGraphEditor3.png" align="middle" alt="Handling additional data for the nodes in a graph"></div>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </center>
            </div>
         </div>
         <div class="highlights">
            <h4><a name="d0e119"></a>Related Resources
            </h4>
            <p>
               You will find related information in the yFiles for Java Tutorial: 
               
            </p>
            <div class="itemizedlist">
               <ul type="disc">
                  <li><a href="../tooltips/index.html" target="_top">Trail: Adding Tooltips to Graph Elements</a></li>
                  <li><a href="../undo_redo/index.html" target="_top">Trail: Undo/Redo Support</a></li>
                  <li><a href="../clipboard/index.html" target="_top">Trail: Clipboard Support</a></li>
               </ul>
            </div>
            <p>
               
               In the yFiles for Java API: 
               
            </p>
            <div class="itemizedlist">
               <ul type="disc">
                  <li><a href="http://www.yworks.com/products/yfiles/doc/api/y/view/Graph2DView.html#Graph2DView(y.view.Graph2D)" title="Link to API documentation" target="_top">Graph2DView(Graph2D)<sup><img src="figures/icon_api.gif" align="bottom" border="0"></sup></a> 
                     constructor
                     
                  </li>
               </ul>
            </div>
            <p>
               
               In the yFiles for Java source code demos: 
               
            </p>
            <div class="itemizedlist">
               <ul type="disc">
                  <li><a href="http://www.yworks.com/products/yfiles/doc/demo/base/ExtendedGraph.java" title="Link to demo code" target="_top">ExtendedGraph.java</a> shows a custom Graph 
                     subclass that encapsulates handling of additional data for both nodes and edges 
                     in a graph
                     
                  </li>
               </ul>
            </div>
            <p>
               
            </p>
         </div>
      </div>
      <table class="copyright" border="0" cellpadding="0" cellspacing="0" width="100%">
         <tbody>
            <tr>
               <td align="right">
                  <p class="copyright">Copyright &copy;2008-2009, yWorks GmbH. All rights reserved.</p>
               </td>
            </tr>
         </tbody>
      </table>
      <div class="navfooter">
         <div class="navline2"></div>
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left"><a accesskey="p" title="Trail:&nbsp;Handling Additional Data for Graph Elements" href="index.html">Prev</a>&nbsp;
               </td>
               <td width="20%" align="center"><a accesskey="u" title="Trail:&nbsp;Handling Additional Data for Graph Elements" href="index.html">Up</a></td>
               <td width="40%" align="right">&nbsp;</td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top">Trail:&nbsp;Handling Additional Data for Graph Elements&nbsp;</td>
               <td width="20%" align="center"><a accesskey="h" title="yFiles for Java Tutorial" href="../index.html">Home</a></td>
               <td width="40%" align="right" valign="top">&nbsp;</td>
            </tr>
         </table>
      </div>
   </body>
</html>